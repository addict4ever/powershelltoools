<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire de Diagnostic Informatique</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1, h2, h3 {
            color: #007bff;
        }
        label {
            font-weight: bold;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input[type="text"],
        .form-group input[type="tel"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            resize: vertical;
        }
        .form-group textarea {
            min-height: 100px;
        }
        .form-group .radio-label {
            margin-right: 15px;
        }
        .form-group .checkbox-label {
            margin-right: 15px;
        }
        .form-group .inline {
            display: inline-block;
            margin-right: 15px;
        }
        .form-group .inline:last-child {
            margin-right: 0;
        }
        .form-group .required::after {
            content: '*';
            color: red;
        }
        .form-group .notes {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        .form-group .notes span {
            font-weight: bold;
            color: #333;
        }
        .submit-btn {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .submit-btn:hover {
            background-color: #0056b3;
        }
        .report-container {
            max-width: 800px;
            margin: 20px auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .report-container h2 {
            color: #007bff;
            margin-bottom: 20px;
        }
        .report-item {
            margin-bottom: 10px;
        }
        .report-item label {
            font-weight: bold;
        }
        .report-item span {
            display: inline-block;
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }
        .report-item textarea {
            width: 100%;
            min-height: 100px;
            resize: vertical;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Formulaire de Diagnostic Informatique</h1>
        <form id="diagnostic-form">
            <div class="form-group">
                <label for="nom-client" class="required">Nom du Client :</label>
                <input type="text" id="nom-client" name="nom-client" required>
            </div>
            <div class="form-group">
                <label for="telephone" class="required">Téléphone :</label>
                <input type="tel" id="telephone" name="telephone" required>
            </div>
            <div class="form-group">
                <label for="type-appareil" class="required">Type d'Appareil :</label>
                <select id="type-appareil" name="type-appareil" required>
                    <option value="">Sélectionner...</option>
                    <option value="Imprimante">Imprimante</option>
                    <option value="Laptop">Laptop</option>
                    <option value="Ordinateur de Bureau">Ordinateur de Bureau</option>
                    <option value="Cellulaire">Cellulaire</option>
                    <option value="Tablette">Tablette</option>
                    <option value="Autre">Autre</option>
                </select>
            </div>
            <div class="form-group">
                <label class="required">Adaptateur de Courant :</label><br>
                <input type="radio" id="adapteur-oui" name="adapteur-courant" value="Oui" required>
                <label class="radio-label" for="adapteur-oui">Oui</label>
                <input type="radio" id="adapteur-non" name="adapteur-courant" value="Non" required>
                <label class="radio-label" for="adapteur-non">Non</label>
            </div>
            <div class="form-group">
                <label for="duree-probleme" class="required">Depuis Quand Durée le Problème Principal :</label>
                <input type="text" id="duree-probleme" name="duree-probleme" required>
            </div>
            <div class="form-group">
                <label for="fonctionnel-moment" class="required">L'appareil est-il Fonctionnel Actuellement ou l'avez-vous Vu Allumé ?</label><br>
                <input type="radio" id="fonctionnel-oui" name="fonctionnel-moment" value="Oui" required>
                <label class="radio-label" for="fonctionnel-oui">Oui</label>
                <input type="radio" id="fonctionnel-non" name="fonctionnel-moment" value="Non" required>
                <label class="radio-label" for="fonctionnel-non">Non</label>
            </div>
            <div class="form-group">
                <label for="virus-infection">Le problème est-il lié à une infection par un virus ou un malware ?</label><br>
                <input type="radio" id="virus-oui" name="virus-infection" value="Oui">
                <label class="radio-label" for="virus-oui">Oui</label>
                <input type="radio" id="virus-non" name="virus-infection" value="Non">
                <label class="radio-label" for="virus-non">Non</label>
            </div>
            <div class="form-group">
                <label>Utilisation Récemment Modifiée :</label><br>
                <input type="checkbox" id="utilisation-modifiee" name="utilisation-modifiee[]" value="Mise à Jour du Système d'Exploitation">
                <label class="checkbox-label" for="utilisation-modifiee">Mise à Jour du Système d'Exploitation</label>
                <input type="checkbox" id="utilisation-modifiee2" name="utilisation-modifiee[]" value="Installation de Nouveaux Programmes">
                <label class="checkbox-label" for="utilisation-modifiee2">Installation de Nouveaux Programmes</label>
                <input type="checkbox" id="utilisation-modifiee3" name="utilisation-modifiee[]" value="Changement de Matériel">
                <label class="checkbox-label" for="utilisation-modifiee3">Changement de Matériel</label>
                <input type="checkbox" id="utilisation-modifiee4" name="utilisation-modifiee[]" value="Suppression de Programmes">
                <label class="checkbox-label" for="utilisation-modifiee4">Suppression de Programmes</label>
            </div>
            <div class="form-group">
                <label for="marque-appareil">Marque de l'Appareil :</label>
                <input type="text" id="marque-appareil" name="marque-appareil">
            </div>
            <div class="form-group">
                <label for="probleme">Description du Problème :</label>
                <textarea id="probleme" name="probleme" rows="4"></textarea>
            </div>
            <div class="form-group">
                <label for="code-erreur">Code d'Erreur (le cas échéant) :</label>
                <input type="text" id="code-erreur" name="code-erreur">
            </div>
            <div class="form-group">
                <label for="système-exploitation">Système d'Exploitation :</label>
                <select id="système-exploitation" name="système-exploitation">
                    <option value="">Sélectionner...</option>
                    <option value="Windows 10">Windows 10</option>
                    <option value="Windows 11">Windows 11</option>
                    <option value="macOS">macOS</option>
                    <option value="Linux">Linux</option>
                    <option value="Autre">Autre</option>
                </select>
            </div>
            <div class="form-group">
                <label for="pieces-remplacees">Pièces Déjà Remplacées :</label>
                <input type="text" id="pieces-remplacees" name="pieces-remplacees">
            </div>
            <div class="form-group">
                <label for="historique-probleme">Historique du Problème :</label>
                <textarea id="historique-probleme" name="historique-probleme" rows="4"></textarea>
                <span class="notes">Inclure les symptômes observés avant d'amener l'appareil.</span>
            </div>
            <div class="form-group">
                <label>Sauvegardes Disponibles :</label><br>
                <input type="radio" id="sauvegardes-oui" name="sauvegardes" value="Oui">
                <label class="radio-label" for="sauvegardes-oui">Oui</label>
                <input type="radio" id="sauvegardes-non" name="sauvegardes" value="Non">
                <label class="radio-label" for="sauvegardes-non">Non</label>
            </div>
            <div class="form-group">
                <label for="antivirus">Antivirus Utilisé :</label>
                <input type="text" id="antivirus" name="antivirus">
            </div>
            <div class="form-group">
                <label for="connexion-reseau">Détails de Connexion Réseau :</label>
                <textarea id="connexion-reseau" name="connexion-reseau" rows="4"></textarea>
            </div>
            <div class="form-group">
                <label>Problèmes de Performances :</label><br>
                <input type="checkbox" id="performances-ralentissements" name="performances[]" value="Ralentissements">
                <label class="checkbox-label" for="performances-ralentissements">Ralentissements</label>
                <input type="checkbox" id="performances-gels" name="performances[]" value="Écrans Gelés">
                <label class="checkbox-label" for="performances-gels">Écrans Gelés</label>
                <input type="checkbox" id="performances-redemarrages" name="performances[]" value="Redémarrages Inattendus">
                <label class="checkbox-label" for="performances-redemarrages">Redémarrages Inattendus</label>
                <input type="checkbox" id="performances-erreurs" name="performances[]" value="Messages d'Erreur">
                <label class="checkbox-label" for="performances-erreurs">Messages d'Erreur</label>
                <input type="checkbox" id="performances-autre" name="performances[]" value="Autre">
                <label class="checkbox-label" for="performances-autre">Autre</label>
            </div>
            <div class="form-group">
                <label for="notes-additionnelles">Notes Additionnelles :</label>
                <textarea id="notes-additionnelles" name="notes-additionnelles" rows="4"></textarea>
            </div>
            <div class="form-group signature-container">
                <label for="signature-client">Signature du Client :</label>
                <input type="text" id="signature-client" name="signature-client">
                <span>Date : <input type="text" id="date-signature" name="date-signature" readonly></span>
            </div>
            <div class="form-group">
                <p>Nous ne sommes pas responsables des problèmes qui peuvent survenir suite à la réparation.</p>
            </div>
            <button type="submit" class="submit-btn">Soumettre</button>
        </form>
    </div>

    <script>
        const diagnosticForm = document.getElementById('diagnostic-form');

        diagnosticForm.addEventListener('submit', function(event) {
            event.preventDefault();
            validateForm();
        });

        function validateForm() {
            const requiredInputs = document.querySelectorAll('.required + input, .required + select, .required + textarea');
            let isValid = true;

            requiredInputs.forEach(input => {
                if (!input.value.trim()) {
                    input.style.border = '1px solid red';
                    isValid = false;
                } else {
                    input.style.border = '1px solid #ccc';
                }
            });

            const radioGroups = document.querySelectorAll('.required + input[type="radio"]');
            radioGroups.forEach(radio => {
                const name = radio.name;
                const radios = document.querySelectorAll(`input[name="${name}"]`);
                let isChecked = false;
                radios.forEach(radio => {
                    if (radio.checked) isChecked = true;
                });
                if (!isChecked) {
                    radios.forEach(radio => radio.nextElementSibling.style.color = 'red');
                    isValid = false;
                } else {
                    radios.forEach(radio => radio.nextElementSibling.style.color = '#333');
                }
            });

            if (isValid) generateReport();
            else alert('Veuillez remplir tous les champs obligatoires.');
        }

        function generateReport() {
            const form = document.getElementById('diagnostic-form');
            const formData = new FormData(form);

            const date = new Date().toLocaleString();
            const filename = `rapport_diagnostic_${new Date().toISOString().replace(/[:\-T]/g, '').split('.')[0]}.html`;

            let reportHtml = `
                <!DOCTYPE html>
                <html lang="fr">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Rapport de Diagnostic Informatique</title>
                    <style>
                        body {
                            font-family: Arial, sans-serif;
                            background-color: #f4f4f9;
                            margin: 0;
                            padding: 20px;
                            color: #333;
                        }
                        .container {
                            max-width: 800px;
                            margin: 0 auto;
                            background-color: #fff;
                            padding: 20px;
                            border-radius: 8px;
                            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
                        }
                        h1, h2, h3, h4 {
                            color: #007bff;
                        }
                        h2, h3 {
                            border-bottom: 2px solid #007bff;
                            padding-bottom: 5px;
                        }
                        pre {
                            background-color: #f4f4f9;
                            padding: 10px;
                            border-left: 4px solid #007bff;
                            overflow-x: auto;
                        }
                        .report-item {
                            margin-bottom: 20px;
                        }
                        .report-item label {
                            font-weight: bold;
                        }
                        .report-item span {
                            display: inline-block;
                            width: 100%;
                            padding: 8px;
                            border: 1px solid #ccc;
                            border-radius: 4px;
                            box-sizing: border-box;
                            margin-top: 5px;
                        }
                        .report-item textarea {
                            width: 100%;
                            min-height: 100px;
                            resize: vertical;
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <h1>Rapport de Diagnostic Informatique</h1>
                        <p>Généré le : ${date}</p>
            `;

            formData.forEach((value, key) => {
                if (value) {
                    reportHtml += `
                        <div class="report-item">
                            <label>${key.replace(/-/g, ' ')}:</label>
                            <span>${value}</span>
                        </div>
                    `;
                }
            });

            const signature = formData.get('signature-client');
            const dateSignature = formData.get('date-signature');
            reportHtml += `
                <div class="report-item">
                    <label>Signature du Client :</label>
                    <span>${signature}</span>
                </div>
                <div class="report-item">
                    <label>Date :</label>
                    <span>${dateSignature}</span>
                </div>
                <div class="report-item">
                    <p>Nous ne sommes pas responsables des problèmes qui peuvent survenir suite à la réparation.</p>
                </div>
            `;

            reportHtml += `
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob([reportHtml], { type: 'text/html' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.target = '_blank';
            link.click();
        }

        document.getElementById('date-signature').value = new Date().toLocaleDateString('fr-CA');
    </script>
</body>
</html>
